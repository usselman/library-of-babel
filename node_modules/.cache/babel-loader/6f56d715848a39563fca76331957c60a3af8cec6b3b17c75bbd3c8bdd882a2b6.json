{"ast":null,"code":"var _jsxFileName = \"/Users/shirishsarkar/Library/Mobile Documents/com~apple~CloudDocs/Documents/_CODE/library-of-babel/src/components/PriceHistoryChart.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { Line } from 'react-chartjs-2';\nimport Chart from 'chart.js/auto';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst PriceHistoryChart = ({\n  data\n}) => {\n  _s();\n  const [exchangeRate, setExchangeRate] = useState(0);\n  useEffect(() => {\n    async function getExchangeRate() {\n      const url = 'https://api.whatsonchain.com/v1/bsv/main/exchangerate';\n      try {\n        const response = await fetch(url);\n        if (!response.ok) {\n          throw new Error('Network response was not ok ' + response.statusText);\n        }\n        const data = await response.json();\n        setExchangeRate(parseFloat(data.rate));\n        console.log(\"Exchange rate fetched: \", exchangeRate);\n      } catch (error) {\n        console.error(\"Fetching exchange rate failed: \", error);\n      }\n    }\n    getExchangeRate();\n  }, []); // Fetch exchange rate when the component mounts\n\n  // Extract values for height, price, and amount from each listing\n  const heights = data.map(item => item.height);\n  const prices = data.map(item => item.data.list.price);\n\n  // Filter out null values (missing data points) from the data\n  const filteredData = data.filter(item => item.origin && item.origin.data && item.origin.data.insc);\n  const amounts = filteredData.map(item => {\n    return parseFloat(item.origin.data.insc.json.amt);\n  });\n\n  // Calculate the price/amount ratio in USD\n  const priceAmountRatioUSD = amounts.map((amt, index) => amt / prices[index] * exchangeRate);\n  console.log(\"Price/amount ratio: \", priceAmountRatioUSD);\n  const marketcap = priceAmountRatioUSD[0] * 21000000;\n  const chartData = {\n    labels: heights.map(String),\n    // Convert heights to strings for the X-axis (category)\n    datasets: [{\n      label: 'Price per Token',\n      data: priceAmountRatioUSD,\n      // Y-axis data (amount/price in USD)\n      fill: false,\n      backgroundColor: 'white',\n      borderColor: 'green',\n      pointRadius: 2 // Set point radius\n    }]\n  };\n\n  const options = {\n    scales: {\n      x: {\n        type: 'category',\n        // Specify x-axis as \"category\"\n        position: 'bottom',\n        reverse: true,\n        // Reverse the x-axis\n        title: {\n          display: true,\n          text: 'Block Height'\n        }\n      },\n      y: {\n        beginAtZero: false,\n        // Start the y-axis at zero\n        title: {\n          display: true,\n          text: 'Price per token (USD)'\n        },\n        ticks: {\n          callback: value => `$${value.toFixed(4)}` // Add '$' symbol and format to 2 decimal places\n        }\n      }\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"text-3xl\",\n      children: [\"Marketcap: $\", marketcap.toFixed(2)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"font-bold\",\n      children: \"Listing Price History (USD) - WIP\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Line, {\n      data: chartData,\n      options: options\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 9\n  }, this);\n};\n_s(PriceHistoryChart, \"gSmWrHFUMOsb5AqG/YgSVfMmPvw=\");\n_c = PriceHistoryChart;\nexport default PriceHistoryChart;\nvar _c;\n$RefreshReg$(_c, \"PriceHistoryChart\");","map":{"version":3,"names":["React","useEffect","useState","Line","Chart","jsxDEV","_jsxDEV","PriceHistoryChart","data","_s","exchangeRate","setExchangeRate","getExchangeRate","url","response","fetch","ok","Error","statusText","json","parseFloat","rate","console","log","error","heights","map","item","height","prices","list","price","filteredData","filter","origin","insc","amounts","amt","priceAmountRatioUSD","index","marketcap","chartData","labels","String","datasets","label","fill","backgroundColor","borderColor","pointRadius","options","scales","x","type","position","reverse","title","display","text","y","beginAtZero","ticks","callback","value","toFixed","children","className","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/shirishsarkar/Library/Mobile Documents/com~apple~CloudDocs/Documents/_CODE/library-of-babel/src/components/PriceHistoryChart.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Line } from 'react-chartjs-2';\nimport Chart from 'chart.js/auto';\n\nconst PriceHistoryChart = ({ data }) => {\n    const [exchangeRate, setExchangeRate] = useState(0);\n\n    useEffect(() => {\n        async function getExchangeRate() {\n            const url = 'https://api.whatsonchain.com/v1/bsv/main/exchangerate';\n            try {\n                const response = await fetch(url);\n                if (!response.ok) {\n                    throw new Error('Network response was not ok ' + response.statusText);\n                }\n                const data = await response.json();\n                setExchangeRate(parseFloat(data.rate));\n                console.log(\"Exchange rate fetched: \", exchangeRate);\n            } catch (error) {\n                console.error(\"Fetching exchange rate failed: \", error);\n            }\n        }\n\n        getExchangeRate();\n    }, []); // Fetch exchange rate when the component mounts\n\n    // Extract values for height, price, and amount from each listing\n    const heights = data.map((item) => item.height);\n    const prices = data.map((item) => item.data.list.price);\n\n    // Filter out null values (missing data points) from the data\n    const filteredData = data.filter((item) => item.origin && item.origin.data && item.origin.data.insc);\n\n    const amounts = filteredData.map((item) => {\n        return parseFloat(item.origin.data.insc.json.amt);\n    });\n\n    // Calculate the price/amount ratio in USD\n    const priceAmountRatioUSD = amounts.map((amt, index) => (amt / prices[index]) * exchangeRate);\n    console.log(\"Price/amount ratio: \", priceAmountRatioUSD);\n    const marketcap = priceAmountRatioUSD[0] * 21000000;\n\n    const chartData = {\n        labels: heights.map(String), // Convert heights to strings for the X-axis (category)\n        datasets: [\n            {\n                label: 'Price per Token',\n                data: priceAmountRatioUSD, // Y-axis data (amount/price in USD)\n                fill: false,\n                backgroundColor: 'white',\n                borderColor: 'green',\n                pointRadius: 2, // Set point radius\n            },\n        ],\n    };\n\n    const options = {\n        scales: {\n            x: {\n                type: 'category', // Specify x-axis as \"category\"\n                position: 'bottom',\n                reverse: true, // Reverse the x-axis\n                title: {\n                    display: true,\n                    text: 'Block Height',\n                },\n            },\n            y: {\n                beginAtZero: false, // Start the y-axis at zero\n                title: {\n                    display: true,\n                    text: 'Price per token (USD)',\n                },\n                ticks: {\n                    callback: (value) => `$${value.toFixed(4)}`, // Add '$' symbol and format to 2 decimal places\n                },\n            },\n        },\n    };\n\n    return (\n        <div>\n            <h1 className=\"text-3xl\">Marketcap: ${marketcap.toFixed(2)}</h1>\n            <h2 className=\"font-bold\">Listing Price History (USD) - WIP</h2>\n            <Line data={chartData} options={options} />\n        </div>\n    );\n};\n\nexport default PriceHistoryChart;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}